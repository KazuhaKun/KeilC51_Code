# 计算器功能使用说明

## 📋 功能概述

已实现完整的计算器功能，满足所有需求：

- ✅ 任意两个八位整数做加法运算
- ✅ 任意两个八位整数做减法运算
- ✅ 任意两个四位整数做乘法运算
- ✅ 任意两个八位整数做除法运算，结果保留四位小数

## 🎮 操作说明

### 1. 进入计算器模式

按红外遥控的 **MODE** 键切换到 Calculator 模式（计算器模式）

### 2. 基本操作流程

```
输入第一个数字 → 选择运算符 → 输入第二个数字 → 查看结果
```

#### 步骤 1: 输入第一个数字 (Num1)

- LCD 第一行显示：`Num1:` 
- 使用数字键 **0-9** 输入数字（加减除法最多8位，乘法最多4位）
- 按 **EQ** 键确认输入，进入运算符选择
- 按 **VOL-** 键清除当前输入

#### 步骤 2: 选择运算符

- LCD 第一行显示：`Select Op:`
- LCD 第二行显示：`+  -  *  /`
- 按键选择：
  - **VOL+** 键：加法 (+)
  - **VOL-** 键：减法 (-)
  - **1** 键：乘法 (×)
  - **2** 键：除法 (÷)
- 按 **START_STOP** 键返回重新输入第一个数

#### 步骤 3: 输入第二个数字 (Num2)

- LCD 第一行显示：`Num2:` 和已输入的数字
- LCD 第二行显示：选择的运算符
- 使用数字键 **0-9** 输入数字
- 输入限制：
  - **加法/减法/除法**：最多 8 位
  - **乘法**：最多 4 位（自动限制）
- 按 **EQ** 键开始计算
- 按 **START_STOP** 键返回重新开始

#### 步骤 4: 查看结果

- LCD 第一行显示：`Result:`
- LCD 第二行显示：计算结果
- 除法结果保留 4 位小数
- 按任意数字键开始新的计算
- 按 **START_STOP** 键清零重新开始

## 📝 使用示例

### 示例 1: 加法运算 (12345678 + 87654321)

```
1. 按 MODE 键进入 Calculator 模式
2. 输入 12345678，按 EQ 确认
3. 按 VOL+ 选择加法
4. 输入 87654321，按 EQ 计算
5. 显示结果: 99999999
```

### 示例 2: 减法运算 (10000000 - 1234567)

```
1. 输入 10000000，按 EQ 确认
2. 按 VOL- 选择减法
3. 输入 1234567，按 EQ 计算
4. 显示结果: 8765433
```

### 示例 3: 乘法运算 (9999 × 8888)

```
1. 输入 9999，按 EQ 确认
2. 按 1 键选择乘法
3. 输入 8888，按 EQ 计算
4. 显示结果: 88881112
```

### 示例 4: 除法运算 (1234567 ÷ 100)

```
1. 输入 1234567，按 EQ 确认
2. 按 2 键选择除法
3. 输入 100，按 EQ 计算
4. 显示结果: 12345.6700
```

## 🔧 按键功能表

| 按键 | 功能 | 使用场景 |
|------|------|----------|
| **MODE** | 切换模式 | 进入/退出计算器模式 |
| **0-9** | 输入数字 | 输入操作数 |
| **EQ** | 确认/计算 | 确认输入或执行计算 |
| **CH+** | 加法 | 运算符选择 |
| **CH-** | 减法/清除 | 运算符选择或清除输入 |
| **1** | 乘法 | 运算符选择 |
| **2** | 除法 | 运算符选择 |
| **START_STOP** | 重新开始 | 清零重新开始计算 |

## ⚙️ 技术细节

### 数据类型

```c
xdata long Calc_Num1;         // 第一个操作数 (支持8位整数)
xdata long Calc_Num2;         // 第二个操作数 (支持8位整数)
xdata float Calc_Result;      // 计算结果 (支持小数)
```

### 状态机

计算器使用状态机设计，包含四个状态：

1. **CALC_INPUT_NUM1**: 输入第一个数
2. **CALC_SELECT_OP**: 选择运算符
3. **CALC_INPUT_NUM2**: 输入第二个数
4. **CALC_SHOW_RESULT**: 显示结果

### 输入限制

| 运算类型 | 第一个数 | 第二个数 | 原因 |
|---------|---------|---------|------|
| 加法 | 最多8位 | 最多8位 | 满足需求 |
| 减法 | 最多8位 | 最多8位 | 满足需求 |
| 乘法 | 最多4位 | 最多4位 | 防止结果溢出 |
| 除法 | 最多8位 | 最多8位 | 满足需求 |

### 结果显示

- **整数结果**：直接显示完整数值
- **小数结果**：保留 4 位小数
- **负数结果**：自动显示负号
- **除数为零**：显示错误提示 "Error: Div by 0"

## 🎯 测试建议

### 测试 1: 基本加法

```
输入: 12345 + 67890
期望: 80235
```

### 测试 2: 负数结果

```
输入: 100 - 200
期望: -100
```

### 测试 3: 乘法最大值

```
输入: 9999 × 9999
期望: 99980001
```

### 测试 4: 除法小数

```
输入: 100 ÷ 3
期望: 33.3333
```

### 测试 5: 除零错误

```
输入: 100 ÷ 0
期望: 显示错误提示
```

## ⚠️ 注意事项

1. **输入范围**：
   - 加减除法支持最大 8 位整数 (最大 99999999)
   - 乘法支持最大 4 位整数 (最大 9999)
   
2. **结果溢出**：
   - 如果结果超出 long 类型范围，可能显示错误
   - 建议控制输入值大小
   
3. **小数精度**：
   - 除法结果保留 4 位小数
   - 其他运算结果为整数
   
4. **操作连续性**：
   - 显示结果后按数字键自动开始新计算
   - 可随时按 START_STOP 重新开始
   
5. **LCD 显示**：
   - 如果数字过长，可能显示不完整
   - 建议使用合理范围的数字

## 🔄 操作流程图

```
┌─────────────────┐
│   进入模式      │
│  (按 MODE 键)   │
└────────┬────────┘
         ↓
┌─────────────────┐
│   输入 Num1     │ ←─┐
│  (数字键 0-9)   │   │
│  (按 EQ 确认)   │   │
└────────┬────────┘   │
         ↓            │
┌─────────────────┐   │
│   选择运算符     │   │
│ VOL+:加 VOL-:减 │   │ 按 START_STOP
│  1:乘  2:除     │   │ 重新开始
└────────┬────────┘   │
         ↓            │
┌─────────────────┐   │
│   输入 Num2     │   │
│  (数字键 0-9)   │   │
│  (按 EQ 计算)   │   │
└────────┬────────┘   │
         ↓            │
┌─────────────────┐   │
│   显示结果      │   │
│  (保留4位小数)  │   │
└────────┬────────┘   │
         │            │
         └────────────┘
```

## 📌 快速参考

### 最常用操作

1. **快速计算**: 数字 → EQ → 运算符 → 数字 → EQ
2. **清除输入**: 按 CH- (在输入 Num1 时)
3. **重新开始**: 按 START_STOP (任何时候)
4. **连续计算**: 结果显示后直接按数字键开始新计算

### 常见问题

**Q: 为什么乘法只能输入4位数字？**  
A: 为了防止结果溢出，乘法限制为4位。例如 9999×9999=99980001，仍在范围内。

**Q: 除法结果为什么不是整数？**  
A: 除法运算默认保留4位小数，以提供更精确的结果。

**Q: 如何输入负数？**  
A: 直接输入数字，通过减法运算可以得到负数结果。

**Q: 输入错误怎么办？**  
A: 在输入第一个数时按 CH-清除，或按 START_STOP 重新开始。

---

**现在可以尽情使用计算器功能了！** 🎉
