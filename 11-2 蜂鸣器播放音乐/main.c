#include <REGX52.H>
#include "delay.h"
#include "Timer0.h"


sbit Buzzer = P2^5;

unsigned int code FreqTable[] = {
	63777,63872,63969,64054,64140,64216,64291,64360,64426,64489,64547,64603,
	64655,64704,64751,64795,64837,64876,64913,64948,64981,65012,65042,65070,
	65095,65120,65144,65166,65186,65206,65225,65242,65259,65274,65289,65303,
	00001
};

unsigned char code Music[] = {
	28,4,
	26,2,
	24,4,
	26,2,//1,1
	28,2,
	28,1,
	29,1,
	28,2,
	26,4+2,//2
	28,4,
	26,2,
	24,4,
	26,2,//3
	28,2+1,
	29,1,
	28,2,
	26,4+2,//4
	28,4,
	26,2,
	24,4,
	26,2,//1,2
	28,2,
	28,1,
	29,1,
	28,2,
	26,4,
	26,2,//2
	28,4,
	26,2,
	24,4+2,//3
	28,2+1,
	29,1,
	28,2,
	26,4,
	12,1,
	12,1,//4
	16,2,
	16,2,
	14,2,
	17,2,
	16,2,
	14,2,//1,3
	14,2,
	14,2,
	12,1,
	12,1,
	17,2,
	16,2,
	14,2,//2
	14,4,
	12,1,
	14,1,
	16,4+2,//3
	36,4+2,
	16,2,
	19,2,
	24,2,//4
	23,4,
	24,2,
	23,4,
	24,2,//1,4
	23,1,
	21,1,
	19,4,
	19,2,
	14,2,
	16,2,//2
	17,4,
	16,2,
	16,4,
	7,2,//3
	17,2,
	16,2,
	14,2,
	16,4,
	19,2,//4
	12,4+2,
	36,4,
	// 12,2,//1,5

};

unsigned char FreqSelect,MusicSelect;

void main()
{
	Timer0Init();
	while(1)
	{
		FreqSelect = Music[MusicSelect];
		MusicSelect++;
		Delay(125*Music[MusicSelect]);
		MusicSelect++;
		TR0 = 0;
		Delay(5);
		TR0 = 1;
	}
}

void Timer0_Routine() interrupt 1
{
	TL0 = FreqTable[FreqSelect] % 256; 
	TH0 = FreqTable[FreqSelect] / 256;
	Buzzer =!Buzzer;
}
