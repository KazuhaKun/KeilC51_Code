# 密码功能使用说明

## 📋 功能概述

已实现8位数字密码设置和验证功能，满足所有需求：
- ✅ 用红外遥控设置八位数字密码
- ✅ 用红外遥控输入八位数字密码
- ✅ 密码正确：调用 `Motor_OpenDoor()` 函数
- ✅ 密码错误：调用 `Buzzer_Alarm()` 函数

## 🎮 操作说明

### 1. 进入密码模式
按红外遥控的 **MODE** 键切换到 Safe 模式（密码模式）

### 2. 验证密码（默认模式）
- LCD 第一行显示：`Enter Password:`
- LCD 第二行显示输入进度（如：`**------` 表示已输入2位）
- 使用数字键 **0-9** 输入8位密码
- 按 **EQ** 键确认
- 如果密码正确：
  - 显示 `Password OK!` 和 `Opening Door...`
  - 调用 `Motor_OpenDoor()` 函数（需要你实现）
- 如果密码错误：
  - 显示 `Wrong Password!` 和 `Buzzer Alarm...`
  - 调用 `Buzzer_Alarm()` 函数（需要你实现）

### 3. 设置新密码
- 在密码模式下，按 **START_STOP** 键切换到"设置密码"模式
- LCD 第一行显示：`Set Password:`
- 使用数字键 **0-9** 输入8位新密码
- 按 **EQ** 键保存
- 显示 `Password Saved!` 确认保存成功
- 新密码会自动保存到 EEPROM，断电不丢失

### 4. 默认密码
首次使用默认密码为：**12345678**

## 🔧 需要你完成的部分

### 1. 实现步进电机控制函数
在 `Motor_OpenDoor()` 函数中实现：
```c
void Motor_OpenDoor(void) {
    // TODO: 你需要在这里实现步进电机控制
    // 要求：正转5圈后反转5圈
    
    // 示例代码框架：
    // Motor_Forward(5 * 步数);  // 正转5圈
    // Delay(...);
    // Motor_Reverse(5 * 步数);  // 反转5圈
    
    LCD_ShowString(1, 1, "Door Opened!    ");
    LCD_ShowString(2, 1, "Motor Running..."); 
    Delay(3000); // 模拟电机运行时间
}
```

### 2. 实现蜂鸣器报警函数
在 `Buzzer_Alarm()` 函数中实现：
```c
void Buzzer_Alarm(void) {
    // TODO: 你需要在这里实现蜂鸣器控制
    // 要求：报警3秒后停止
    
    // 示例代码框架：
    // Buzzer = 1;  // 开启蜂鸣器
    // Delay(3000); // 持续3秒
    // Buzzer = 0;  // 关闭蜂鸣器
    
    LCD_ShowString(1, 1, "Wrong Password! ");
    LCD_ShowString(2, 1, "Buzzer Alarm... ");
    Delay(3000); // 模拟蜂鸣器报警3秒
}
```

## 📝 技术细节

### 变量定义
```c
#define PASSWORD_LENGTH 8                          // 密码长度
xdata unsigned char Saved_Password[8];             // 保存的密码
xdata unsigned char Input_Password[8];             // 输入的密码
bit Safe_Mode;                                     // 0:验证, 1:设置
```

### EEPROM 地址分配
- `0x00-0x06`: 万年历时间数据
- `0x10-0x17`: 密码数据（8字节）
- `0x18`: 密码初始化标志

### 函数接口
- `Password_Init()`: 初始化密码系统（在 main 函数中已调用）
- `Password_Save()`: 保存密码到 EEPROM
- `Password_Verify()`: 验证密码是否正确
- `Password_Display()`: 显示密码输入界面
- `Motor_OpenDoor()`: **需要你实现** - 步进电机开门
- `Buzzer_Alarm()`: **需要你实现** - 蜂鸣器报警

## 🎯 测试步骤

1. **上传程序** 到单片机
2. **按 MODE 键** 两次，切换到 Safe 模式
3. **输入默认密码** 12345678，按 EQ 确认
4. **观察** 是否调用 `Motor_OpenDoor()` 函数
5. **故意输入错误密码**，按 EQ 确认
6. **观察** 是否调用 `Buzzer_Alarm()` 函数
7. **按 START_STOP** 切换到设置模式
8. **输入新密码**（如 88888888），按 EQ 保存
9. **用新密码测试** 验证功能

## ⚠️ 注意事项

1. 密码保存在 EEPROM 中，断电不丢失
2. 每次写入 EEPROM 后需要延时（代码中已处理）
3. 输入过程中，当前位置会闪烁显示 `_`
4. 已输入的位置显示 `*`，未输入显示 `-`
5. 可以随时按 MODE 键退出密码模式

## 📌 快速参考

| 按键 | 功能 |
|------|------|
| MODE | 切换模式（Calendar → Safe → Calculator） |
| 0-9 | 输入密码数字 |
| EQ | 确认输入 |
| START_STOP | 切换设置/验证模式 |

---

**开发完成后记得实现 `Motor_OpenDoor()` 和 `Buzzer_Alarm()` 两个函数！** 🚀
