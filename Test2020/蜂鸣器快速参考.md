# 蜂鸣器快速参考

## 🔌 硬件连接

```
单片机引脚    蜂鸣器
  P2.5   ---> I/O（信号）
  VCC    ---> VCC（电源）
  GND    ---> GND（地）
```

**蜂鸣器类型**：无源蜂鸣器（需要PWM信号）

---

## 📝 API 函数

### 1. 报警3秒（主要功能）
```c
void Buzzer_Alarm_3s(void);
```
- **功能**：蜂鸣器报警3秒后自动停止
- **频率**：约1kHz
- **用途**：密码错误时的报警提示

**调用示例**：
```c
if (!Password_Verify()) {
    // 密码错误
    Buzzer_Alarm_3s();
}
```

### 2. 自定义时长（基础函数）
```c
void Buzzer_Time(unsigned int ms);
```
- **参数**：ms - 报警时长（毫秒）
- **频率**：约1kHz

**调用示例**：
```c
Buzzer_Time(1000);  // 响1秒
Buzzer_Time(5000);  // 响5秒
```

---

## 🎯 密码锁集成

### 密码错误触发报警

```c
// 在 Safe_Proc() 函数中
if (Current_Input.Input_Finished) {
    if (!Safe_Mode) {
        if (Password_Verify()) {
            // ✅ 密码正确 - 开门
            Motor_OpenDoor();
        } else {
            // ❌ 密码错误 - 报警
            Buzzer_Alarm();  // 调用main.c中的封装函数
        }
    }
}
```

### main.c中的封装函数

```c
void Buzzer_Alarm(void) {
    LCD_ShowString(1, 1, "Wrong Password! ");
    LCD_ShowString(2, 1, "Buzzer Alarm... ");
    
    Buzzer_Alarm_3s();  // 蜂鸣器响3秒
    
    LCD_ShowString(2, 1, "Alarm Stopped!  ");
    Delay(1000);
}
```

---

## ⏱️ 时序说明

| 事件 | 时间 |
|-----|------|
| 显示"Wrong Password!" | 0ms |
| 显示"Buzzer Alarm..." | 0ms |
| 蜂鸣器启动 | 0ms |
| 蜂鸣器停止 | 3000ms |
| 显示"Alarm Stopped!" | 3000ms |
| 返回输入界面 | 4000ms |
| **总耗时** | **约4秒** |

---

## 📊 技术参数

| 参数 | 值 |
|-----|---|
| 控制引脚 | P2.5 |
| 蜂鸣器类型 | 无源 |
| 工作电压 | 3.3V/5V |
| 频率 | ~1kHz |
| 报警时长 | 3秒 |
| 波形 | 方波（翻转） |

---

## 🔧 常见问题

| 问题 | 解决方法 |
|-----|---------|
| 蜂鸣器不响 | 1. 检查接线<br>2. 确认是无源蜂鸣器<br>3. 测试P2.5引脚输出 |
| 声音很小 | 1. 检查电源电压<br>2. 调整翻转频率 |
| 时长不准 | 1. 确认晶振11.0592MHz<br>2. 调整参数 |
| 持续响 | 确保有 `Buzzer = 1;` 停止 |

---

## 🧪 测试步骤

1. **进入密码锁模式**
   ```
   按 MODE 键 → 切换到 Safe 模式
   ```

2. **输入错误密码**
   ```
   输入: 11111111（非正确密码）
   按 EQ 键确认
   ```

3. **检查结果**
   - ✅ LCD显示"Wrong Password!"
   - ✅ LCD显示"Buzzer Alarm..."
   - ✅ 蜂鸣器响起（约1kHz）
   - ✅ 持续3秒
   - ✅ 自动停止
   - ✅ LCD显示"Alarm Stopped!"

---

## 🎓 波形图

```
P2.5引脚波形（1kHz方波）:

     500us    500us
    <----> <----->
     ___      ___      ___
 ___|   |____|   |____|   |____
    
    高电平   低电平
    
周期 = 1ms
频率 = 1kHz
```

---

## ⚙️ 有源蜂鸣器适配

如果使用**有源蜂鸣器**（只需高/低电平控制）：

```c
void Buzzer_Alarm_3s(void)
{
    Buzzer = 0;      // 低电平响（或改为1）
    Delay(3000);     // 响3秒
    Buzzer = 1;      // 高电平停（或改为0）
}
```

---

## 📁 相关文件

- `Buzzer.h` - 函数声明
- `Buzzer.c` - 蜂鸣器驱动实现
- `main.c` - `Buzzer_Alarm()` 封装函数
- `蜂鸣器报警功能说明.md` - 详细技术文档

---

## ✅ 状态

- [x] 代码实现完成
- [x] 编译通过无错误
- [ ] 硬件测试
- [ ] 密码错误触发测试

---

**版本**: v1.0 | **日期**: 2025-10-15 | **状态**: ✅ 已完成
